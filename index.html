<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chord Progression Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a1a;
            color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background-color: #2b2b2b;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .controls label {
            font-size: 1.25rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .controls select {
            background-color: #444;
            color: #e0e0e0;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid #555;
            appearance: none;
            cursor: pointer;
            text-align: center;
            width: 150px;
        }

        .mode-toggle {
            display: flex;
            background-color: #444;
            border-radius: 0.5rem;
            overflow: hidden;
        }

        .mode-toggle button {
            padding: 0.5rem 1rem;
            background-color: transparent;
            color: #e0e0e0;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .mode-toggle button.active {
            background-color: #666;
            font-weight: bold;
        }

        .chord-section {
            background-color: #383838;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .chord-title {
            text-align: center;
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-transform: uppercase;
        }

        .chord-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
        }

        .chord-item {
            background-color: #4a4a4a;
            color: #e0e0e0;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-weight: 700;
            text-align: center;
            min-width: 85px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            position: relative;
            padding-top: 1.5rem;
        }

        .chord-roman {
            position: absolute;
            top: 0.25rem;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            font-weight: bold;
            color: #a0a0a0;
            white-space: nowrap;
        }
    </style>
</head>

<body>

    <div class="container mx-auto p-6">
        <div class="controls">
            <div>
                <label for="key-select">Key</label><br>
                <select id="key-select">
                    <option value="C">C</option>
                    <option value="C#">C#</option>
                    <option value="Db">Db</option>
                    <option value="D">D</option>
                    <option value="Eb">Eb</option>
                    <option value="E">E</option>
                    <option value="F">F</option>
                    <option value="F#">F#</option>
                    <option value="Gb">Gb</option>
                    <option value="G">G</option>
                    <option value="Ab">Ab</option>
                    <option value="A">A</option>
                    <option value="Bb">Bb</option>
                    <option value="B">B</option>
                </select>
            </div>

            <div>
                <label>Mode</label><br>
                <div class="mode-toggle">
                    <button id="major-btn" class="active">Major</button>
                    <button id="minor-btn">Minor</button>
                </div>
            </div>
        </div>

        <div class="chord-section">
            <div class="chord-title">Main Chords</div>
            <div id="main-chords-grid" class="chord-grid"></div>
        </div>

        <div class="chord-section">
            <div class="chord-title" id="secondary-v-title">Secondary Dominants</div>
            <div id="secondary-v-grid" class="chord-grid"></div>
        </div>

        <div class="chord-section">
            <div class="chord-title" id="secondary-iv-title">Modal Interchange</div>
            <div id="secondary-iv-grid" class="chord-grid"></div>
        </div>

        <div class="chord-section mt-6">
            <div class="chord-title">Tips</div>
            <div id="tips-content"></div>
        </div>
    </div>

    <script>
        const keySelect = document.getElementById('key-select');
        const mainChordsGrid = document.getElementById('main-chords-grid');
        const secondaryVGrid = document.getElementById('secondary-v-grid');
        const secondaryIvGrid = document.getElementById('secondary-iv-grid');
        const tipsContent = document.getElementById('tips-content');
        const majorBtn = document.getElementById('major-btn');
        const minorBtn = document.getElementById('minor-btn');

        let currentMode = 'major';

        const chromaticScale = ['C', 'C#', 'D', 'Eb', 'E', 'F', 'F#', 'G', 'Ab', 'A', 'Bb', 'B'];

        const majorScales = {
            'C': ['C', 'D', 'E', 'F', 'G', 'A', 'B'],
            'C#': ['C#', 'D#', 'E#', 'F#', 'G#', 'A#', 'B#'],
            'Db': ['Db', 'Eb', 'F', 'Gb', 'Ab', 'Bb', 'C'],
            'D': ['D', 'E', 'F#', 'G', 'A', 'B', 'C#'],
            'Eb': ['Eb', 'F', 'G', 'Ab', 'Bb', 'C', 'D'],
            'E': ['E', 'F#', 'G#', 'A', 'B', 'C#', 'D#'],
            'F': ['F', 'G', 'A', 'Bb', 'C', 'D', 'E'],
            'F#': ['F#', 'G#', 'A#', 'B', 'C#', 'D#', 'E#'],
            'Gb': ['Gb', 'Ab', 'Bb', 'Cb', 'Db', 'Eb', 'F'],
            'G': ['G', 'A', 'B', 'C', 'D', 'E', 'F#'],
            'Ab': ['Ab', 'Bb', 'C', 'Db', 'Eb', 'F', 'G'],
            'A': ['A', 'B', 'C#', 'D', 'E', 'F#', 'G#'],
            'Bb': ['Bb', 'C', 'D', 'Eb', 'F', 'G', 'A'],
            'B': ['B', 'C#', 'D#', 'E', 'F#', 'G#', 'A#']
        };

        const minorScales = {
            'C': ['C', 'D', 'Eb', 'F', 'G', 'Ab', 'Bb'],
            'C#': ['C#', 'D#', 'E', 'F#', 'G#', 'A', 'B'],
            'Db': ['Db', 'Eb', 'Fb', 'Gb', 'Ab', 'Bbb', 'Cb'],
            'D': ['D', 'E', 'F', 'G', 'A', 'Bb', 'C'],
            'Eb': ['Eb', 'F', 'Gb', 'Ab', 'Bb', 'Cb', 'Db'],
            'E': ['E', 'F#', 'G', 'A', 'B', 'C', 'D'],
            'F': ['F', 'G', 'Ab', 'Bb', 'C', 'Db', 'Eb'],
            'F#': ['F#', 'G#', 'A', 'B', 'C#', 'D', 'E'],
            'Gb': ['Gb', 'Ab', 'Bbb', 'Cb', 'Db', 'Ebb', 'Fb'],
            'G': ['G', 'A', 'Bb', 'C', 'D', 'Eb', 'F'],
            'Ab': ['Ab', 'Bb', 'Cb', 'Db', 'Eb', 'Fb', 'Gb'],
            'A': ['A', 'B', 'C', 'D', 'E', 'F', 'G'],
            'Bb': ['Bb', 'C', 'Db', 'Eb', 'F', 'Gb', 'Ab'],
            'B': ['B', 'C#', 'D', 'E', 'F#', 'G', 'A']
        };

        function simplify(note) {
            const enharmonicMap = { 'E#': 'F', 'Cb': 'B', 'B#': 'C', 'Fb': 'E', 'Bbb': 'A', 'Ebb': 'D' };
            return enharmonicMap[note] || note;
        }

        function getDominantSeventh(note) {
            const index = chromaticScale.indexOf(simplify(note));
            const dominantIndex = (index + 7) % 12;
            return `${chromaticScale[dominantIndex]}7`;
        }

        function getMajorChords(key) {
            const scale = majorScales[key];
            const minorScale = minorScales[key];

            const mainChords = [
                { note: scale[0], numeral: 'I' },
                { note: scale[1] + 'm', numeral: 'ii' },
                { note: scale[2] + 'm', numeral: 'iii' },
                { note: scale[3], numeral: 'IV' },
                { note: scale[4], numeral: 'V' },
                { note: scale[5] + 'm', numeral: 'vi' }
            ];

            const secondaryDominants = [
                { note: getDominantSeventh(scale[0]), numeral: 'V7/I' },
                { note: getDominantSeventh(scale[1]), numeral: 'V7/ii' },
                { note: getDominantSeventh(scale[2]), numeral: 'V7/iii' },
                { note: getDominantSeventh(scale[3]), numeral: 'V7/IV' },
                { note: getDominantSeventh(scale[4]), numeral: 'V7/V' },
                { note: getDominantSeventh(scale[5]), numeral: 'V7/vi' }
            ];

            const modalInterchange = [
                { note: minorScale[2], numeral: '♭III' },
                { note: minorScale[5], numeral: '♭VI' },
                { note: minorScale[3] + 'm', numeral: 'iv' },
                { note: minorScale[6], numeral: '♭VII' }
            ];

            return { mainChords, secondaryDominants, modalInterchange };
        }

        function getMinorChords(key) {
            const scale = minorScales[key];

            const mainChords = [
                { note: scale[0] + 'm', numeral: 'i' },
                { note: scale[1] + '°', numeral: 'ii°' },
                { note: scale[2], numeral: 'III' },
                { note: scale[3] + 'm', numeral: 'iv' },
                { note: scale[4], numeral: 'V' },
                { note: scale[5], numeral: 'VI' },
                { note: scale[6], numeral: 'VII' }
            ];

            return { mainChords, secondaryDominants: [], modalInterchange: [] };
        }

        function renderChords(container, chords) {
            container.innerHTML = '';
            chords.forEach(chord => {
                const item = document.createElement('div');
                item.className = 'chord-item';

                const roman = document.createElement('div');
                roman.className = 'chord-roman';
                roman.textContent = chord.numeral;

                const note = document.createElement('span');
                note.textContent = chord.note;

                item.appendChild(roman);
                item.appendChild(note);
                container.appendChild(item);
            });
        }

        function updateTips() {
            if (currentMode === 'major') {
                tipsContent.innerHTML = `
                    <ul class="list-disc list-inside space-y-2 text-sm text-gray-400">
                        <li>Major progressions are easy: try I-IV-V-I.</li>
                        <li>You can add secondary dominants for variation (V7/ii, etc.).</li>
                        <li>Modal interchange chords (♭III, ♭VI, iv, ♭VII) add color.</li>
                    </ul>
                `;
            } else {
                tipsContent.innerHTML = `
                    <ul class="list-disc list-inside space-y-2 text-sm text-gray-400">
                        <li>Minor progressions are simple: try i-iv-v-i.</li>
                        <li>Use III, VI, VII to create smooth, playable progressions.</li>
                         <li>The v chord is actually <strong>minor</strong> but often played as <strong>major</strong> or <strong>maj7</strong> for a stronger resolution.</li>
                    </ul>
                `;
            }
        }

        function updateDisplay() {
            const key = keySelect.value;
            let chords = currentMode === 'major' ? getMajorChords(key) : getMinorChords(key);

            const secondaryVSection = secondaryVGrid.parentElement;
            const secondaryIvSection = secondaryIvGrid.parentElement;

            renderChords(mainChordsGrid, chords.mainChords);

            if (chords.secondaryDominants.length > 0) {
                secondaryVSection.style.display = 'block';
                renderChords(secondaryVGrid, chords.secondaryDominants);
            } else {
                secondaryVSection.style.display = 'none';
            }

            if (chords.modalInterchange.length > 0) {
                secondaryIvSection.style.display = 'block';
                renderChords(secondaryIvGrid, chords.modalInterchange);
            } else {
                secondaryIvSection.style.display = 'none';
            }

            updateTips();
        }

        // Event listeners
        keySelect.addEventListener('change', updateDisplay);

        majorBtn.addEventListener('click', () => {
            currentMode = 'major';
            majorBtn.classList.add('active');
            minorBtn.classList.remove('active');
            updateDisplay();
        });

        minorBtn.addEventListener('click', () => {
            currentMode = 'minor';
            minorBtn.classList.add('active');
            majorBtn.classList.remove('active');
            updateDisplay();
        });

        window.onload = updateDisplay;
    </script>
</body>

</html>